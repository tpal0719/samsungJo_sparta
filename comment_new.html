<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Comment Box</title>

    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <style>
        #comment-section {
            display: grid;
            margin: 10px;
        }

        #name, #comment {
            margin-bottom: 10px;
            width: 100%;
        }

        #comments-list {
            margin-top: 20px;
            border-top: 1px solid #000;
        }

        .green-btn {
            background-color: #28a745;
            border-color: #28a745;
        }

        .green-btn:hover {
            background-color: #218838;
            border-color: #1e7e34;
        }
    </style>
</head>
<body>

    <div id="comment-section">
        <input type="text" id="name" placeholder="이름" />
        <textarea id="comment" placeholder="댓글 내용"></textarea>
        <button id="submit">등록</button>
    </div>
    
    <div id="comments-list">
        <!-- Comments will be listed here -->
    </div>
    <script>
        document.getElementById('submit').addEventListener('click', function() {
            const nameValue = document.getElementById('name').value.trim();
            const commentValue = document.getElementById('comment').value.trim();
            
            if (nameValue && commentValue) {
                addComment(nameValue, commentValue);
            } else {
                alert('이름과 댓글 내용을 입력해주세요.');
            }
        });

        function addComment(name, comment) {
            const commentSection = document.getElementById('comments-list');
            const now = new Date();
            const timestamp = `${now.getMonth() + 1}/${now.getDate()} ${now.getHours()}:${now.getMinutes().toString().padStart(2, '0')}`;
            
            // Create the comment element
            const commentElement = document.createElement('div');
            commentElement.classList.add('single-comment');
            
            // Add the comment text
            const commentText = document.createElement('span');
            commentText.textContent = comment;
            commentElement.appendChild(commentText);
            
            // Add name label
            const nameLabel = document.createElement('strong');
            nameLabel.textContent = `${name} | `;
            commentElement.insertBefore(nameLabel, commentText);
            
            // Add timestamp
            const timeLabel = document.createElement('span');
            timeLabel.textContent = ` (${timestamp}) `;
            commentElement.appendChild(timeLabel);

            // Add edit button
            const editButton = document.createElement('button');
            editButton.textContent = '수정';
            editButton.className = 'btn green-btn btn-sm';
            editButton.onclick = function() {
                const editableText = document.createElement('textarea');
                editableText.value = commentText.textContent;
                commentText.replaceWith(editableText);
                editButton.replaceWith(saveButton);
            };
            commentElement.appendChild(editButton);
            
            // Add save button
            const saveButton = document.createElement('button');
            saveButton.textContent = '저장';
            saveButton.className = 'btn green-btn btn-sm';
            saveButton.onclick = function() {
                const updatedComment = editableText.value.trim();
                if (updatedComment) {
                    commentText.textContent = updatedComment;
                    editableText.replaceWith(commentText);
                    saveButton.replaceWith(editButton);
                } else {
                    alert('댓글 내용을 입력해주세요.');
                }
            };
            
            // Add delete button
            const deleteButton = document.createElement('button');
            deleteButton.textContent = '삭제';
            deleteButton.className = 'btn green-btn btn-sm';
            deleteButton.onclick = function() {
                commentSection.removeChild(commentElement);
            };
            commentElement.appendChild(deleteButton);
            
            // Add the new comment to the top of the comment section
            commentSection.insertBefore(commentElement, commentSection.firstChild);
            
            // Clear the input fields
            document.getElementById('name').value = '';
            document.getElementById('comment').value = '';
        }
    </script>

    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-database.js"></script>
    <script src="app.js"></script>
</body>
</html>